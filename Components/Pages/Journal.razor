<h3>Journal</h3>
@page "/"


@page "/journal"
@inject JournalApp.Services.IJournalService JournalService
@inject NavigationManager Nav

<h1 class="screen-title">Journal</h1>

<button class="primary-btn" @onclick="GoToday">Add Today's Entry</button>

<div class="list">
    @if (entries is null)
    {
        <p>Loading...</p>
    }
    else if (entries.Count == 0)
    {
        <p>No entries yet.</p>
    }
    else
    {
        @foreach (var e in entries)
        {
            <button class="list-item" @onclick="() => OpenDate(e.EntryDate)">
                @e.EntryDate.ToString("dd MMM, yyyy") - @e.Title
            </button>
        }
    }
</div>

@code {
    private List<JournalApp.Data.Entities.JournalEntry>? entries;

    protected override async Task OnInitializedAsync()
    {
        entries = await JournalService.GetRecentAsync(20);
    }

    private void GoToday() => OpenDate(DateTime.Today);

    private void OpenDate(DateTime d)
    {
        var dateStr = d.ToString("yyyy-MM-dd");
        Nav.NavigateTo($"/entry/{dateStr}");
    }
}

